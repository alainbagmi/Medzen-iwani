<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simple Chime SDK Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>Chime SDK Simple Load Test</h1>
    <div id="status"></div>
    <div id="details"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const detailsDiv = document.getElementById('details');

        function addStatus(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            statusDiv.appendChild(div);
        }

        function addDetail(title, content) {
            const div = document.createElement('div');
            div.innerHTML = `<h3>${title}</h3><pre>${content}</pre>`;
            detailsDiv.appendChild(div);
        }

        addStatus('Starting SDK load test...', 'info');

        // Create script element dynamically
        const script = document.createElement('script');
        script.src = 'https://d2n29hdfurdqmu.cloudfront.net/chime-sdk-3.19.0.min.js';
        script.crossOrigin = 'anonymous';

        script.onload = function() {
            console.log('✅ Script onload fired');
            addStatus('✅ Script tag onload event fired', 'success');

            // Check if SDK is available
            setTimeout(() => {
                if (typeof window.ChimeSDK !== 'undefined') {
                    addStatus('✅ SUCCESS: window.ChimeSDK is defined!', 'success');

                    // List available classes
                    const classes = Object.keys(window.ChimeSDK);
                    addDetail('Available SDK Classes (' + classes.length + ' total)',
                             classes.slice(0, 20).join(', ') + '...');

                    // Test key classes
                    const keyClasses = [
                        'ConsoleLogger',
                        'DefaultDeviceController',
                        'DefaultMeetingSession',
                        'MeetingSessionConfiguration'
                    ];

                    let allFound = true;
                    const results = {};

                    keyClasses.forEach(cls => {
                        const exists = typeof window.ChimeSDK[cls] !== 'undefined';
                        results[cls] = exists ? '✅' : '❌';
                        if (!exists) allFound = false;
                    });

                    addDetail('Key SDK Classes', JSON.stringify(results, null, 2));

                    if (allFound) {
                        addStatus('✅ All required SDK classes available', 'success');
                    } else {
                        addStatus('⚠️ Some SDK classes missing', 'error');
                    }

                } else {
                    addStatus('❌ FAIL: window.ChimeSDK is undefined', 'error');
                    addDetail('window object keys', Object.keys(window).join(', '));
                }
            }, 100);
        };

        script.onerror = function(error) {
            console.error('❌ Script onerror fired:', error);
            addStatus('❌ Script failed to load (onerror event)', 'error');
            addDetail('Error', 'Network error or CORS issue. Check browser console.');
        };

        document.head.appendChild(script);
        addStatus('Script tag added to document', 'info');
    </script>
</body>
</html>
