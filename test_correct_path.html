<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>üéØ Correct Path Test</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            padding: 40px;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255,255,255,0.95);
            padding: 40px;
            border-radius: 16px;
            color: #1f2937;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        h1 { color: #1e40af; margin-top: 0; }
        .status {
            padding: 16px 20px;
            margin: 12px 0;
            border-radius: 8px;
            font-weight: 600;
            font-size: 15px;
        }
        .success {
            background: #dcfce7;
            color: #166534;
            border-left: 4px solid #16a34a;
        }
        .error {
            background: #fee2e2;
            color: #991b1b;
            border-left: 4px solid #dc2626;
        }
        .info {
            background: #dbeafe;
            color: #1e40af;
            border-left: 4px solid #3b82f6;
        }
        pre {
            background: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #e5e7eb;
            font-size: 13px;
        }
        .highlight {
            background: #fef3c7;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #f59e0b;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Testing Correct SDK Path</h1>
        <div id="results"></div>
    </div>

    <script>
        const results = document.getElementById('results');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = message;
            results.appendChild(div);
            console.log(`[${type}]`, message);
        }

        function showCode(title, code) {
            const div = document.createElement('div');
            div.innerHTML = `<h3>${title}</h3><pre>${code}</pre>`;
            results.appendChild(div);
        }

        log('Testing correct CDN paths...', 'info');

        const cdnsToTest = [
            'https://unpkg.com/amazon-chime-sdk-js@latest/dist/amazon-chime-sdk.min.js',
            'https://cdn.jsdelivr.net/npm/amazon-chime-sdk-js@latest/dist/amazon-chime-sdk.min.js',
            'https://unpkg.com/amazon-chime-sdk-js@3/dist/amazon-chime-sdk.min.js'
        ];

        let currentIndex = 0;

        function testNextCDN() {
            if (currentIndex >= cdnsToTest.length) {
                log('‚ùå All CDN paths failed', 'error');
                log('This suggests the SDK build structure may have changed or there\'s a compatibility issue', 'info');
                return;
            }

            const url = cdnsToTest[currentIndex];
            log(`Testing: <code>${url}</code>`, 'info');

            const script = document.createElement('script');
            script.src = url;
            script.crossOrigin = 'anonymous';

            script.onload = () => {
                setTimeout(() => {
                    if (window.ChimeSDK && typeof window.ChimeSDK === 'object') {
                        log(`‚úÖ SUCCESS! SDK loaded from this CDN`, 'success');

                        const keys = Object.keys(window.ChimeSDK);
                        log(`‚úÖ ${keys.length} classes available`, 'success');

                        showCode('Available Classes (first 30)', keys.slice(0, 30).join('\n'));

                        // Test instantiation
                        try {
                            const logger = new window.ChimeSDK.ConsoleLogger('TestLogger', 1);
                            logger.info('Test log message');

                            log('‚úÖ Successfully created ConsoleLogger!', 'success');

                            // Show usage example
                            const highlight = document.createElement('div');
                            highlight.className = 'highlight';
                            highlight.innerHTML = `
                                <h3>‚ú® Use This CDN in Your Widget:</h3>
                                <pre>&lt;script src="${url}"&gt;&lt;/script&gt;</pre>
                                <p><strong>Then access via:</strong> <code>window.ChimeSDK</code></p>
                            `;
                            results.appendChild(highlight);

                        } catch (err) {
                            log(`‚ùå Failed to instantiate: ${err.message}`, 'error');
                            currentIndex++;
                            setTimeout(testNextCDN, 500);
                        }

                    } else if (window.ChimeSDK !== undefined) {
                        log(`‚ùå SDK property exists but value is: ${window.ChimeSDK}`, 'error');
                        currentIndex++;
                        setTimeout(testNextCDN, 500);
                    } else {
                        log(`‚ùå SDK not found on window`, 'error');
                        currentIndex++;
                        setTimeout(testNextCDN, 500);
                    }
                }, 500);
            };

            script.onerror = () => {
                log(`‚ùå Failed to load (404 or network error)`, 'error');
                currentIndex++;
                setTimeout(testNextCDN, 500);
            };

            document.head.appendChild(script);
        }

        testNextCDN();
    </script>
</body>
</html>
